<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>XySSL: x509.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>x509.h</h1><a href="x509_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00004 <span class="preprocessor">#ifndef _X509_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define _X509_H</span>
00006 <span class="preprocessor"></span>
00007 <span class="preprocessor">#ifdef __cplusplus</span>
00008 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00009 <span class="preprocessor">#endif</span>
00010 <span class="preprocessor"></span>
00011 <span class="preprocessor">#ifndef _STD_TYPES</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define _STD_TYPES</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#define uchar   unsigned char</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define uint    unsigned int</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#define ulong   unsigned long int</span>
00017 <span class="preprocessor"></span>
00018 <span class="preprocessor">#endif</span>
00019 <span class="preprocessor"></span>
00020 <span class="preprocessor">#include "<a class="code" href="rsa_8h.html">rsa.h</a>"</span>
00021 
00022 <span class="preprocessor">#define ERR_ASN1_OUT_OF_DATA                    0x0014</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define ERR_ASN1_UNEXPECTED_TAG                 0x0016</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#define ERR_ASN1_INVALID_LENGTH                 0x0018</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#define ERR_ASN1_LENGTH_MISMATCH                0x001A</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define ERR_ASN1_INVALID_DATA                   0x001C</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#define ERR_X509_CERT_INVALID_PEM               0x0020</span>
00029 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_FORMAT            0x0040</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_VERSION           0x0060</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_SERIAL            0x0080</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_ALG               0x00A0</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_NAME              0x00C0</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_DATE              0x00E0</span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_PUBKEY            0x0100</span>
00036 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_SIGNATURE         0x0120</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_INVALID_EXTENSIONS        0x0140</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_UNKNOWN_VERSION           0x0160</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_UNKNOWN_SIG_ALG           0x0180</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_UNKNOWN_PK_ALG            0x01A0</span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_CERT_SIG_MISMATCH              0x01C0</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_INVALID_PEM                0x01E0</span>
00043 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_INVALID_VERSION            0x0200</span>
00044 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_INVALID_FORMAT             0x0220</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_INVALID_ENC_IV             0x0240</span>
00046 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_UNKNOWN_ENC_ALG            0x0260</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_PASSWORD_REQUIRED          0x0280</span>
00048 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_KEY_PASSWORD_MISMATCH          0x02A0</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define ERR_X509_SIG_VERIFY_FAILED              0x02C0</span>
00050 <span class="preprocessor"></span>
00051 <span class="preprocessor">#define BADCERT_HAS_EXPIRED             1</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#define BADCERT_CN_MISMATCH             2</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#define BADCERT_NOT_TRUSTED             4</span>
00054 <span class="preprocessor"></span>
00055 <span class="comment">/*</span>
00056 <span class="comment"> * some DER constants</span>
00057 <span class="comment"> */</span>
00058 <span class="preprocessor">#define ASN1_BOOLEAN                 0x01</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_INTEGER                 0x02</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_BIT_STRING              0x03</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OCTET_STRING            0x04</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_NULL                    0x05</span>
00063 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OID                     0x06</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UTF8_STRING             0x0C</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_SEQUENCE                0x10</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_SET                     0x11</span>
00067 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_PRINTABLE_STRING        0x13</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_T61_STRING              0x14</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_IA5_STRING              0x16</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UTC_TIME                0x17</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UNIVERSAL_STRING        0x1C</span>
00072 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_BMP_STRING              0x1E</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_PRIMITIVE               0x00</span>
00074 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_CONSTRUCTED             0x20</span>
00075 <span class="preprocessor"></span><span class="preprocessor">#define ASN1_CONTEXT_SPECIFIC        0x80</span>
00076 <span class="preprocessor"></span>
00077 <span class="comment">/*</span>
00078 <span class="comment"> * various object identifiers</span>
00079 <span class="comment"> */</span>
00080 <span class="preprocessor">#define X520_COMMON_NAME                3</span>
00081 <span class="preprocessor"></span><span class="preprocessor">#define X520_COUNTRY                    6</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define X520_LOCALITY                   7</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define X520_STATE                      8</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define X520_ORGANIZATION              10</span>
00085 <span class="preprocessor"></span><span class="preprocessor">#define X520_ORG_UNIT                  11</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define PKCS9_EMAIL                     1</span>
00087 <span class="preprocessor"></span>
00088 <span class="preprocessor">#define OID_X520                "\x55\x04"</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS1               "\x2A\x86\x48\x86\xF7\x0D\x01\x01"</span>
00090 <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS1_RSA           "\x2A\x86\x48\x86\xF7\x0D\x01\x01\x01"</span>
00091 <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS9               "\x2A\x86\x48\x86\xF7\x0D\x01\x09"</span>
00092 <span class="preprocessor"></span>
00093 <span class="keyword">typedef</span> <span class="keyword">struct </span>_x509_buf
00094 {
00095     <span class="keywordtype">int</span> tag;
00096     <span class="keywordtype">int</span> len;
00097     uchar *p;
00098 }
00099 x509_buf;
00100 
00101 <span class="keyword">typedef</span> <span class="keyword">struct </span>_x509_name
00102 {
00103     x509_buf oid;
00104     x509_buf val;
00105     <span class="keyword">struct </span>_x509_name *next;
00106 }
00107 x509_name;
00108 
00109 <span class="keyword">typedef</span> <span class="keyword">struct </span>_x509_time
00110 {
00111     <span class="keywordtype">int</span> year, mon, day;
00112     <span class="keywordtype">int</span> hour, min, sec;
00113 }
00114 x509_time;
00115 
00116 <span class="keyword">typedef</span> <span class="keyword">struct </span>_x509_cert
00117 {
00118     x509_buf raw;
00119     x509_buf tbs;
00120 
00121     <span class="keywordtype">int</span> version;
00122     x509_buf serial;
00123     x509_buf sig_oid1;
00124 
00125     x509_name issuer;
00126     x509_time valid_from;
00127     x509_time valid_to;
00128     x509_name subject;
00129 
00130     x509_buf pk_oid;
00131     rsa_context rsa;
00132 
00133     x509_buf issuer_id;
00134     x509_buf subject_id;
00135     x509_buf v3_ext;
00136 
00137     <span class="keywordtype">int</span> ca_istrue;
00138     <span class="keywordtype">int</span> max_pathlen;
00139 
00140     x509_buf sig_oid2;
00141     x509_buf sig;
00142 
00143     <span class="keyword">struct </span>_x509_cert *next; 
00144 }
00145 x509_cert;
00146 
00157 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a66">x509_add_certs</a>( x509_cert *chain, uchar *buf, <span class="keywordtype">int</span> buflen );
00158 
00168 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a67">x509_read_crtfile</a>( x509_cert *chain, <span class="keywordtype">char</span> *path );
00169 
00181 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a68">x509_parse_key</a>( rsa_context *rsa, uchar *buf, <span class="keywordtype">int</span> buflen,
00182                                       uchar *pwd, <span class="keywordtype">int</span> pwdlen );
00183 
00193 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a69">x509_read_keyfile</a>( rsa_context *rsa, <span class="keywordtype">char</span> *path, <span class="keywordtype">char</span> *password );
00194 
00199 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a70">dn_gets</a>( <span class="keywordtype">char</span> *buf, <span class="keywordtype">char</span> *end, x509_name *dn );
00200 
00205 <span class="keywordtype">char</span> *<a class="code" href="x509_8h.html#a71">x509_cert_info</a>( x509_cert *crt );
00206 
00211 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a72">x509_is_cert_expired</a>( x509_cert *crt );
00212 
00229 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a73">x509_verify_cert</a>( x509_cert *crt, x509_cert *trust_ca,
00230                       <span class="keywordtype">char</span> *cn, <span class="keywordtype">int</span> *flags );
00231 
00235 <span class="keywordtype">void</span> <a class="code" href="x509_8h.html#a74">x509_free_cert</a>( x509_cert *crt );
00236 
00242 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#a75">x509_self_test</a>( <span class="keywordtype">void</span> );
00243 
00244 <span class="preprocessor">#ifdef __cplusplus</span>
00245 <span class="preprocessor"></span>}
00246 <span class="preprocessor">#endif</span>
00247 <span class="preprocessor"></span>
00248 <span class="preprocessor">#endif </span><span class="comment">/* x509.h */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Feb 1 10:52:59 2007 for XySSL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
